<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="{{ seometa.AUTHOR }}">
        <meta name="description" content="{{ seometa.DESCRIPTION }}">
        <meta name="keywords" content="{{ seometa.KEYWORDS }}">
        <meta name="webmaster" content="{{ seometa.WEBMASTER }}">	  
        <meta name="robots" content="index, follow">
        <meta property="og:title" content="{{ profileData.FIRST_NAME }} the Alliance Cluster Concierge">
        <meta property="og:description" content="{{ seometa.DESCRIPTION }}">
        <meta property="og:image" content="{{ url_for('static', filename=profileData.IMAGE_FILE) }}">
        <meta property="og:url" content="{{ request.url_root[:-1] }}">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="{{ profileData.FIRST_NAME }} the Alliance Cluster Concierge">
        <meta name="twitter:description" content="{{ seometa.DESCRIPTION }}">
        <meta name="twitter:image" content="{{ url_for('static', filename=profileData.IMAGE_FILE) }}">
        <link rel="canonical" href="{{ request.url_root[:-1] }}">
        <meta name="csrf-token" content="{{ csrf_token() }}">
        <title>{{ profileData.FIRST_NAME }} the Alliance Cluster Concierge</title>
        <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicons/favicon_16x16.png') }}">
        <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicons/favicon_32x32.png') }}">
        <link rel="icon" type="image/png" sizes="48x48" href="{{ url_for('static', filename='favicons/favicon_48x48.png') }}">
        <link rel="icon" type="image/png" sizes="64x64" href="{{ url_for('static', filename='favicons/favicon_64x64.png') }}">
        <link rel="icon" type="image/png" sizes="96x96" href="{{ url_for('static', filename='favicons/favicon_96x96.png') }}">
        <link rel="icon" type="image/png" sizes="128x128" href="{{ url_for('static', filename='favicons/favicon_128x128.png') }}">
        <link rel="icon" type="image/png" sizes="192x192" href="{{ url_for('static', filename='favicons/favicon_192x192.png') }}">
        <link rel="icon" type="image/png" sizes="256x256" href="{{ url_for('static', filename='favicons/favicon_256x256.png') }}">
        <link rel="icon" type="image/png" sizes="512x512" href="{{ url_for('static', filename='favicons/favicon_512x512.png') }}">
        <!-- Apple Touch Icons -->
        <link rel="apple-touch-icon" sizes="120x120" href="{{ url_for('static', filename='favicons/favicon_120x120.png') }}">
        <link rel="apple-touch-icon" sizes="152x152" href="{{ url_for('static', filename='favicons/favicon_152x152.png') }}">
        <link rel="apple-touch-icon" sizes="167x167" href="{{ url_for('static', filename='favicons/favicon_167x167.png') }}">
        <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='favicons/favicon_180x180.png') }}">
        <!-- Windows Tiles -->
        <meta name="msapplication-square70x70logo" content="{{ url_for('static', filename='favicons/favicon_70x70.png') }}">
        <meta name="msapplication-square150x150logo" content="{{ url_for('static', filename='favicons/favicon_150x150.png') }}">
        <meta name="msapplication-square310x310logo" content="{{ url_for('static', filename='favicons/favicon_310x310.png') }}">
        <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Person",
          "name": "{{ profileData.FIRST_NAME }} the Alliance Cluster Concierge",
          "url": "{{ request.url_root[:-1] }}",
          "sameAs": [
            {% if seometa.LINKEDIN %}"{{ seometa.LINKEDIN }}"{% endif %}{% if seometa.LINKEDIN and (seometa.TWITTER or seometa.FACEBOOK) %},{% endif %}
            {% if seometa.TWITTER %}"{{ seometa.TWITTER }}"{% endif %}{% if seometa.TWITTER and seometa.FACEBOOK %},{% endif %}
            {% if seometa.FACEBOOK %}"{{ seometa.FACEBOOK }}"{% endif %}
          ]
        }
        </script>
        <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "Organization",
          "name": "{{ seometa.ORG_NAME }}",
          "url": "{{ seometa.ORG_URL }}",
          "contactPoint": {
            "@type": "ContactPoint",
            "email": "{{ seometa.ORG_EMAIL }}",
            "contactType": "customer service"
          }
        }
        </script>	
        <link href="{{ url_for('static', filename='fonts/montserrat/montserrat.css') }}" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
        <style>
            body {
                font-family: 'Montserrat', sans-serif;
            }

            /* Disabled Send Button */
            .send-button.disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            /* Optionally, style the disabled input */
            #message-input:disabled {
                /* background-color: #e5e7eb;  Tailwind's gray-200 */
                cursor: not-allowed;
            }
        </style>
    </head>
    <body class="bg-gray-100 box-border">
        <!-- Main Content -->
        <div class="flex flex-col min-h-screen">
            <!-- Chat Content -->
            <div class="chat-content flex-1 bg-white flex flex-col justify-between p-4 pt-10">
                <!-- Hero Section -->
                <div class="hero-section flex flex-col justify-center items-center p-4 flex-1">
                    <!-- Profile Image -->
                    <div class="profile-image relative rounded-full w-[100px] h-[100px] lg:w-[200px] lg:h-[200px] overflow-hidden mt-[5vh] lg:mt-[10vh]">
                        <img id="hero-avatar" alt="{{ profileData.FIRST_NAME }} the Alliance Cluster Concierge - Profile Image" loading="lazy" decoding="async" class="rounded-full" style="width: 250px; height: 250px; object-fit: cover;" src="{{ url_for('static', filename=profileData.IMAGE_FILE) }}">
                    </div>
                    <!-- Greeting -->
                    <div class="greeting py-6 text-2xl lg:text-[36px] text-center font-serif mb-[5vh] lg:mb-[10vh]">
                        <p>Hello! I'm {{ profileData.FIRST_NAME }}, the AI Cluster Concierge for the Digital Research Alliance of Canada.</p>
                        <br>
                        <p>How can I help you today?</p>
                    </div>
                </div>
                <!-- Chat Options -->
                <div class="chat-options flex flex-wrap justify-center items-center gap-4 mb-[5vh] lg:mb-[10vh]">
                    <!-- Options List -->
                    <div class="options-list flex flex-wrap gap-4 justify-center items-start">
                        <!-- Option 1 -->
                        <div
                            class="option w-[75%] sm:w-2/4 md:w-2/9 lg:w-1/5 xl:w-1/5 text-sm lg:text-base py-4 pr-4 border-t border-[#E1E1E1] cursor-pointer text-center break-words"
                            onclick='submitPrompt({{ profileData.PROMPT1  | tojson | safe }})'
                            >
                            {{ profileData.PROMPT1 }}
                        </div>
                        <!-- Option 2 -->
                        <div
                            class="option w-[75%] sm:w-2/4 md:w-2/9 lg:w-1/5 xl:w-1/5 text-sm lg:text-base py-4 pr-4 border-t border-[#E1E1E1] cursor-pointer text-center break-words"
                            onclick='submitPrompt({{ profileData.PROMPT2 | tojson | safe }})'
                            >
                            {{ profileData.PROMPT2 }}
                        </div>
                        <!-- Option 3 -->
                        <div
                            class="option w-[75%] sm:w-2/4 md:w-2/9 lg:w-1/5 xl:w-1/5 text-sm lg:text-base py-4 pr-4 border-t border-[#E1E1E1] cursor-pointer text-center break-words"
                            onclick='submitPrompt({{ profileData.PROMPT3 | tojson | safe }})'
                            >
                            {{ profileData.PROMPT3 }}
                        </div>
                        <!-- Add more options here -->
                    </div>
                </div>
            </div>
            <!-- Input Box -->
            <div class="w-full p-4 pb-8 bg-white overflow-hidden">
                <div class="max-w-screen-md mx-auto">
                    <div class="max-w-screen-md bg-gray-100 mx-auto rounded-2xl flex items-center px-2 bg-[#F3F3F3] rounded-[24px] flex items-center px-2">
                        <!-- Main Textarea for User Input -->
                        <textarea
                            id="message-input"
                            rows="1"
                            autofocus
                            placeholder="Ask {{ profileData.FIRST_NAME }}"
                            class="flex-1 text-base px-6 py-4 h-full bg-transparent border-none outline-none resize-none"
                            style="height: 49px; overflow: hidden;"
                            ></textarea>
                        <!-- Hidden Textarea (for auto-resizing, if applicable) -->
                        <textarea
                            aria-hidden="true"
                            class="flex-1 text-base px-6 py-4 h-full bg-transparent border-none outline-none resize-none"
                            readonly
                            tabindex="-1"
                            style="visibility: hidden; position: absolute; overflow: hidden; height: 0px; top: 0px; left: 0px; transform: translateZ(0px); padding-top: 0px; padding-bottom: 0px; width: 718px;"
                            ></textarea>
                        <!-- Send Button -->
                        <button id="send-button" class="send-button" aria-label="Send message">
                            <!-- SVG Icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="none">
                                <path
                                    fill="currentColor"
                                    d="M17.231 24.477h1.576V14.339l4.432 4.43 1.061-1.061-6.262-6.223-6.3 6.223 1.062 1.061 4.431-4.43zM18.006 36q-3.72 0-6.989-1.417a18.3 18.3 0 0 1-5.724-3.871 18.3 18.3 0 0 1-3.875-5.718Q0 21.729 0 18.006q0-3.733 1.417-7.02t3.871-5.718a18.5 18.5 0 0 1 5.719-3.85Q14.27 0 17.994 0q3.734 0 7.02 1.417 3.287 1.418 5.718 3.846 2.431 2.43 3.85 5.713Q36 14.259 36 17.994q0 3.72-1.417 6.989a18.6 18.6 0 0 1-3.846 5.724q-2.43 2.458-5.713 3.874Q21.741 36 18.006 36"
                                    ></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Footer -->
            <div class="bg-black text-gray-300 h-[65px] min-h-[20px] flex justify-between items-center px-6 mt-auto" style="min-height: 20px; flex-shrink: 0;">
                <!-- Left side content -->
                <a href="https://github.com/infiniflow/ragflow" class="flex gap-3 items-center">
                    <img src="{{ url_for('static', filename='images/logo/ragflow_logo_col.png') }}" alt="Ragflow Logo" style="max-height: 18px;" />
                    <span class="hidden sm:inline">RAG by Ragflow.io</span>
                </a>
                <!-- Right side content -->{% if aiProvider == 'GROQCLOUD' %}
                <a href="https://console.groq.com/playground" class="flex gap-3 items-center">
                    <span class="hidden sm:inline">AI by Groq</span>
                    <img src="{{ url_for('static', filename='images/logo/groq.webp') }}" alt="Groq Cloud" style="max-height: 15px;">
                </a>{% elif aiProvider == 'OPENAI' %}
                <a href="https://platform.openai.com/" class="flex gap-3 items-center">
                    <span class="hidden sm:inline">AI by OpenAI</span>
                    <img src="{{ url_for('static', filename='images/logo/openai.webp') }}" alt="OpenAI" style="max-height: 18px;">
                </a>{% elif aiProvider == 'ANTHROPIC' %}
                <a href="https://www.anthropic.com/" class="flex gap-3 items-center">
                    <span class="hidden sm:inline">AI by Anthropic</span>
                    <img src="{{ url_for('static', filename='images/logo/anthropic.webp') }}" alt="Anthropic" style="max-height: 15px;">
                </a>{% elif aiProvider == 'GOOGLE' %}
                <a href="https://ai.google.com/" class="flex gap-3 items-center">
                    <span class="hidden sm:inline">AI by Google</span>
                    <img src="{{ url_for('static', filename='images/logo/google_ai.webp') }}" alt="Google AI" style="max-height: 20px;">
                </a>{% endif %}
            </div>
        </div>
        <script>
            function submitPrompt(messageContent) {
                // Disable the send button and input field
                const sendButton = document.getElementById('send-button');
                const messageInput = document.getElementById('message-input');
                sendButton.disabled = true;
                sendButton.classList.add('disabled'); // Add a CSS class for styling
                messageInput.disabled = true;

                // Create a form element
                var form = document.createElement('form');
                form.method = 'POST';
                form.action = '/chat';

                // Create input for the message content
                var messageInputHidden = document.createElement('input');
                messageInputHidden.type = 'hidden';
                messageInputHidden.name = 'message';
                messageInputHidden.value = messageContent;
                form.appendChild(messageInputHidden);

                // Include CSRF token if necessary
                var csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
                var csrfInput = document.createElement('input');
                csrfInput.type = 'hidden';
                csrfInput.name = 'csrf_token';
                csrfInput.value = csrfToken;
                form.appendChild(csrfInput);

                // Append the form to the body and submit
                document.body.appendChild(form);
                form.submit();
            }

            // Attach an event listener to the send button
            document.getElementById('send-button').addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default form submission behavior

                // Get the message content from the textarea
                var messageContent = document.getElementById('message-input').value;

                // Check if the message is not empty
                if (messageContent.trim() === '') {
                    return; // Do nothing if message is empty
                }

                // Optionally disable the input and button while processing
                submitPrompt(messageContent);
            });

            // Handle Enter and Shift+Enter in the textarea
            document.getElementById('message-input').addEventListener('keydown', function(event) {
                if (event.key === 'Enter') {
                    if (!event.shiftKey) {
                        event.preventDefault(); // Prevent inserting a newline
                        document.getElementById('send-button').click(); // Trigger send button click
                    }
                }
            });
        </script>
    </body>
</html>
